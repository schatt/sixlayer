---
description: Required principles to follow for all agents.
globs: **/*.swift, **/*.m, **/*.h, **/*.pl, **/*.pm, **/*.yml, **/*.yaml, **/*.json, **/*.md
alwaysApply: true
---

# Always follow these principles.

## **Core Principles**
TDD. DTRT. DRY. Epistemology

## **TDD (Test-Driven Development)**
- **MANDATORY**: Write tests BEFORE implementing features
- **MANDATORY**: Follow Red-Green-Refactor cycle
- **MANDATORY**: Red phase ends when tests COMPILE (and fail) - stubs may be required
- **MANDATORY**: Green phase begins when tests compile (and fail)
- **MANDATORY**: No feature implementation without tests first
- **MANDATORY**: All tests must pass before any release
- **MANDATORY**: See `MANDATORY_TESTING_RULES.md` Rule 1 for detailed TDD process including breaking API change strategy

## **DTRT (Do The Right Thing)**
- **MANDATORY**: Implement proper solutions, not quick fixes
- **MANDATORY**: Follow established patterns and best practices
- **MANDATORY**: Write maintainable, readable code
- **MANDATORY**: Consider long-term implications of decisions

## **DRY (Don't Repeat Yourself)**
- **MANDATORY**: Eliminate code duplication
- **MANDATORY**: Extract common functionality into reusable components
- **MANDATORY**: Use abstractions appropriately
- **MANDATORY**: Refactor when patterns emerge

## **Epistemology (Distinguish Facts from Hypotheses)**
- **MANDATORY**: Distinguish between verified facts and unverified hypotheses
- **MANDATORY**: Use precise language that reflects current knowledge
- **MANDATORY**: Investigate before asserting - prefer tentative language until verification
- **MANDATORY**: Acknowledge limitations and uncertainties

## **Release Quality Gate**
- **MANDATORY**: Never create or suggest with any release unless the test suite passes completely
- **MANDATORY**: Always run `swift test` first before any release activities
- **MANDATORY**: Stop all release activities if tests fail
- **MANDATORY**: Fix failing tests before proceeding with releases

## **Git Hygiene (Commit Early and Often)**
- **MANDATORY**: Encourage small, cohesive commits made early and often rather than large, delayed changesets.
- **MANDATORY**: Before switching tasks or contexts, check for a logical unit of work to commit.
- **MANDATORY**: Keep working trees clean; avoid accumulating unrelated uncommitted changes across many files.
- **MANDATORY**: Follow the Git commit message practices defined in `.cursorrules` (clear what/why, issue links, imperative mood).
